---
title: "Population Genomics Lab Notebook "
output: 
  html_document:
    code_folding: show
    theme:
      bg: "black"
      fg: "azure"
      primary: "greenyellow"
      secondary: "darkolivegreen"
      base_font:
        google: Prompt
      heading_font:
        google: Proza Libre
      
---

```{r setup, include=FALSE}
if (requireNamespace("thematic")) 
  thematic::thematic_rmd(font = "auto")
```

## Author: Maryam Nouri-Aiin
#### Affiliation: PSS
#### E-mail contact: [mnouriai\@uvm.edu](mailto:mnouriai@uvm.edu){.email}
##### Start Date: 09-11-2023
##### End Date: TBD

## Project Descriptions
Notebook to document the bioinformatic of [Population Genomics](https://pespenilab.github.io/Ecological-Genomics/Tutorials.html)

## Entries {.tabset .tabset-pills}


### Entry 1: 2023-09-11. 
  
- Get background on the study system (Red spruce, Picea rubens), and the experimental design of the exome capture data
- Understand the general work flow or “pipeline” for processing and analyzing the exome capture sequence data
- Visualize and interpret Illumina data quality (what is a fastq file; what are Phred (Q) scores?).
- Learn how to make/write a bash script, and how to use bash commands to process files in batches
- Trim the reads based on base quality scores in preparation for mapping to the reference genome
- Red spruce study system and exome capture file
- Structure of fastq file (DNA sequences, plus the Qscores)
- Using program FastQC, analyzed the sequencing run for one file
 

### Entry 2: 2023-09-13

- FastQC results discussion, good qulaity sequence data for most reads
- Initial 5 bp or so had more variable base frequncies, The very end of reads had slightly lower @-score
- Based on this we set up an analysis to trim the reads, using 'fastq' program
- bash script run  'fast.sh'
- looked at html files produced by 'fastq' and compared pre- and post-trimming -- things looked good!
- We ended the day setting up our read mapping of the trimmed and cleaned read using 'tmux'


### Entry 3: 2023-09-18

- Review visualizing QC on our sequence reads
- Trim reads using fastp and assess pre- and post trimming
- Start mapping (a.k.a. aligning) each set of cleaned reads to a reference genome
- Visualize sequence alignment files
- Calculate mapping statistics to assess quality of the result

### Entry 4: 2023-09-20

- Finish calculating mapping statistics to assess quality of the result
- Introduce use of genotype-likelihoods for analyzing diversity in low coverage sequences
- Use the ‘ANGSD’ program to calculate nucleotide diversity (thetas) and neutrality stats

### Entry 5: 2023-09-25

- Calculate diversity stats for our focal pops (SFS, theta-W, theta-Pi, Tajima’s D)
- Summarize the results in R and share to google doc
- Introduce Fst in ANGSD using genotype probabilities

### Entry 6: 2023-09-27

- Review the diversity stats for our focal pops on the google doc
- Estimate genetic differentiation (Fst) in ANGSD between our focal red spruce pops and black spruce
- Visualize population structure using PCA and Admixture

### Entry 7: 2023-10-02

- Review the population structure results
- Perform a scan for selection and identify contigs with outlier loci
- Identify and visualize outlier loci


### Entry 8: 2023-10-04

- Revisit pcANGSD selection scan to output genetic PCs and outlier loci list
- Extract climate data for red spruce localities and summarize with PCA
- Run genotype-environment association (GEA) analysis running
